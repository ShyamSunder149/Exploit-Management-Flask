from app import db 
from flask_login import UserMixin 
from sqlalchemy.sql import func

class User(db.Model, UserMixin):
    id = db.Column(db.Integer, primary_key = True)
    email = db.Column(db.String(150), index=True, unique=True)
    password = db.Column(db.String(150))
    username = db.Column(db.String(150), index=True)
    createdAt = db.Column(db.DateTime(timezone=True), default=func.now(), nullable=False)
    role = db.Column(db.String(10), default="user", index=True, nullable=False)
    securityQuestion = db.Column(db.String(150), nullable=False)
    securityAnswer = db.Column(db.String(150))
    exploit = db.relationship('Exploit')

    def as_dict(self):
        return {'email' : self.email, 'username' : self.username, 'id' : self.id, 'role': self.role}


