from flask_login import UserMixin
from app import db

class Exploit(db.Model, UserMixin):
    exploitName = db.Column(db.String(255), index = True, nullable = False, unique = True)
    exploitId = db.Column(db.Integer, index = True, nullable=False, primary_key=True)
    exploitFile = db.Column(db.String(255), nullable = False)
    isApproved = db.Column(db.Boolean, index = True, nullable = False)
    description = db.Column(db.String(1024), nullable = False)
    exploitType = db.Column(db.String(100), index = True, nullable = False)
    platform = db.Column(db.String(100), index = True, nullable = False)
    userId = db.Column(db.Integer, db.ForeignKey('user.id'))

    requiredItems = []

    def as_dict(self):
        return {'exploitName' : self.exploitName, 'exploitFile' : self.exploitFile, 'isApproved' : self.isApproved, 'description' : self.description, 'exploitType' : self.exploitType, 'platform' : self.platform, 'userId' : self.userId}