from flask import Blueprint, jsonify, request
from .views.test import *
from .views.user import *
from .views.exploit import *

main = Blueprint('main', __name__)

main.route('/', methods=['GET'])(test_conn)

main.route('/exploit/', methods=['GET'])(get_exploit_with_params)
main.route('/exploit/<int:exploit_id>', methods=['GET'])(get_exploit_by_id)
main.route('/exploit/', methods=['POST'])(create_exploit)
main.route('/exploit/', methods=['DELETE'])(delete_exploit)
main.route('/exploit/<int:exploit_id>', methods=['PATCH'])(update_exploit)

main.route('/user/register', methods=['POST'])(create_user)
main.route('/user/login', methods=['POST'])(login)
main.route('/user/logout')(logout)
main.route('/user/', methods=['GET'])(get_all_users)
main.route('/user/', methods=['DELETE'])(delete_user)
main.route('/user/current', methods=['GET'])(get_current_user)
main.route('/user/<int:user_id>', methods=['GET'])(get_user_by_id)
main.route('/user/rolebased', methods=['GET'])(get_user_by_role)
main.route('/user/<int:user_id>', methods=['PATCH'])(update_user)

@main.errorhandler(404)
def err_404(err):
    return jsonify({'message':'The page requested in not found'}), 404
